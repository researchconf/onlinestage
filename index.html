<!DOCTYPE html>
<html lang="ja" style="height: 100%;">
<head>
    <meta charset="utf-8" />
    <title>Research Conference Online Stage</title>
    <link rel="stylesheet" type="text/css" href="style.css" /> 
    <script src="jquery.js"></script>
    <script src="script.js"></script>
    <script src="https://unpkg.com/@ungap/custom-elements-builtin"></script>
    <script type="module" src="https://unpkg.com/x-frame-bypass"></script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6NEGRHNZL2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-6NEGRHNZL2');
</script>
<!-- Google tag (gtag.js) ここまで -->
<body style="height: 100%; margin:0;">
  <div id="miroframewrapper" style="width: 100%; height: 100%;">
    <!--<iframe id="miroframe" style="display: block; width: 100%; height: 100%;" src="" frameborder="0" scrolling="no" allow="fullscreen; clipboard-read; clipboard-write" allowfullscreen></iframe>-->
  </div>  
  <script>
    function textToHTML(src){
      // HTML文字列
      const htmlString = '<iframe src="'+src+'"></iframe>';

      // DOMParserを使ってDOMに変換
      const parser = new DOMParser();
      const dom = parser.parseFromString(htmlString, "text/html");

      console.log(dom.documentElement);

      return htmlString;
    }
    function iframeAdd(src){
      var iframeText = '<iframe src="' + src + '">';
      $('#miroframewrapper').append(iframeText);
    }
    fetch("__MiroURL.txt")
      .then((response) => response.text())
      // .then((data) => document.querySelector("#miroframewrapper").innerHTML = '<iframe id="miroframe" style="display: block; width: 100%; height: 100%;" src="' + data + '" frameborder="0" scrolling="no" allow="fullscreen; clipboard-read; clipboard-write" allowfullscreen></iframe>')
      // .then((data) => document.querySelector("#miroframewrapper").innerHTML = "<iframe id='miroframe' style='display: block; width: 100%; height: 100%;' src='" + data + "' frameborder='0' scrolling='no' allow='fullscreen; clipboard-read; clipboard-write' allowfullscreen></iframe>")
      // .then((data) => document.querySelector("#miroframewrapper").innerHTML = data.toString());
      // .then((data) => $('<iframe src="'+data+'">').appendTo('#miroframewrapper'));
      // .then((data) => document.querySelector("#miroframewrapper").innerHTML = textToHTML(data));
      .then((data) => iframeAdd(data));
    /*function setIframeSrc(url){ 
      if(!url) url = 'https://miro.com/app/live-embed/uXjVMGu1VOw=/';
      var iframeDom ='<iframe id="miroframe" style="display: block; width: 100%; height: 100%;" src="' + url + '" frameborder="0" scrolling="no" allow="fullscreen; clipboard-read; clipboard-write" allowfullscreen  is="x-frame-bypass"></iframe>';
      document.getElementById('miroframewrapper').innerHTML = iframeDom;
      document.getElementById('miroframe').contentDocument.location.replace(url);
    }
    $.ajax({
      url: "__MiroURL.txt",
      dataType: "text",
      cache: false,
      success: function(data, textStatus){
        setIframeSrc(data);
      },
      error: function(xhr, textStatus, errorThrown){
        console.log('ajax error');
      }
    });*/
  </script>
</body>
</html>
